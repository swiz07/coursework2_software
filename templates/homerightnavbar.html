{% load static %}

<head>
    <link rel="stylesheet" href="{% static 'health_check/css/navstyle.css'%}">

    <script>
        /*
            * Title: Animated Skills Progress Chart
              * Author: Reza Farhadi
              * Date: October 2024
              * Code version: v5.3
              * Availability:https://bootstrapexamples.com/@reza-f/animated-skills-progress-chart
        */
            
        document.addEventListener('DOMContentLoaded', () => {
            const skills = document.querySelectorAll('.skill-item');
            const animateSkill = (skill) => {
                const circle = skill.querySelector('.progress');
                const percent = skill.dataset.percent;
                const percentText = skill.querySelector('.skill-percent');
                const radius = circle.r.baseVal.value;
                const circumference = radius * 2 * Math.PI;
                const offset = circumference - (percent / 100) * circumference;
                circle.style.strokeDashoffset = offset;
                let count = 0;
                const timer = setInterval(() => {
                    if (count >= percent) {
                        clearInterval(timer);
                    } else {
                        count++;
                        percentText.textContent = count + '%';
                    }
                }, 15);
            };
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('show');
                        animateSkill(entry.target);
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });
            skills.forEach(skill => observer.observe(skill));
        });
    </script>
</head>

<nav class="col-auto col-md-3 col-xl-2   class1 navbar-right">
    <div class="container-fluid p-0">

        <!-- User Profile Section -->
        <div class="col-auto col-md-3 col-xl-2   class2">

            <!-- User Info -->
            <div class="d-flex flex-column align-items-sm-start px-1 pt-2 text-white min-vh-100">
                <a href="{% url 'profile' %}" style="text-decoration: none; color: inherit;"> 
                <div class="userprofile d-flex align-items-center p-2 mb-3">
                    <img src="{% static 'health_check/images/biguser.png' %}" alt="" class="usericon me-2">
                    <div class="d-flex flex-column">
                        <p class="userinfo mb-0 username">{{ request.user.fullname }}</p>
                        <p class="userinfo mb-0 rolename">{{ request.user.role.name }}</p>
                    </div>
                </div>
            </a>

            <!--
                * Title: Animated Skills Progress Chart
                * Author: Reza Farhadi
                * Date: October 2024
                * Code version: v5.3
                * Availability:https://bootstrapexamples.com/@reza-f/animated-skills-progress-chart
            -->

            {% if request.resolver_match.view_name == 'voting_page' %}
                <!-- Vote Progress -->
                {%if is_engineer or is_team_leader%}
                <div class="progress d-flex align-items-center">
                    <div class="col-sm-6 col-md-4 mb-4">
                        <div class="skill-item mx-auto animated" data-skill="Votes" data-percent="{{ percentage_voted }}">
                            <svg class="skill-circle">
                                <circle class="bg" cx="70" cy="70" r="70"></circle>
                                <circle class="progress" cx="70" cy="70" r="70"></circle>
                            </svg>
                            <div class="skill-text">
                                <div class="skill-percent">{{ percentage_voted }}</div>
                                <div class="skill-name">votes</div>
                            </div>
                        </div>
                    </div>  
                </div>
                {%endif%}
                {% endif %}
            </div>

        </div>
    </div>
</nav>